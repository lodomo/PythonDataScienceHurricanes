---
title: "Data Cleaning for Hurricane Dataset"
date: last-modified
author: "Logan MacFarlane and Lorenzo D. Moon"
format: 
    html:
        embed-resources: true
jupyter: python3
---

# Data Cleaning for Hurricane Dataset

## Importing Libraries

```{python}
import pandas as pd
import numpy as np
```

## Loading the Dataset

```{python}
df = pd.read_csv('Atlantic_Hurricanes_1970-2024.csv')


def check_all(df):
    print(df.head())
    print(df.info())
    print(df.describe())
    print(df.isnull().sum())


check_all(df)
```

## Tidying

```{python}
# Convert column names to snake_case
df = df.rename(columns={
    "OBJECTID": "object_id",
    "SID": "sid",
    "BASIN": "basin",
    "SUBBASIN": "sub_basin",
    "NAME": "name",
    "NATURE": "nature",
    "Date": "date",
    "LAT": "latitude",
    "LON": "longitude",
    "USA_WIND": "usa_wind",
    "USA_PRES": "usa_pres",
})

check_all(df)
```

## Treat Missing Values

### Treat Missing Basin Information

```{python}
# Create dataframe of names with basin info
basin_info = df[['name', 'basin']].dropna().drop_duplicates()

# Fill in missing basin info based on name.
for index, row in df[df['basin'].isnull()].iterrows():
    name = row['name']
    if name in basin_info['name'].values:
        basin = basin_info[basin_info['name'] == name]['basin'].values[0]
        df.at[index, 'basin'] = basin

check_all(df)
```

### Treat Missing Sub-Basin Information

```{python}
# Create dataframe of names with sub-basin info
sub_basin_info = df[['name', 'sub_basin']].dropna().drop_duplicates()

# Fill in missing sub-basin info based on name.
for index, row in df[df['sub_basin'].isnull()].iterrows():
    name = row['name']
    if name in sub_basin_info['name'].values:
        sub_basin = sub_basin_info[sub_basin_info['name'] == name]['sub_basin'].values[0]
        df.at[index, 'sub_basin'] = sub_basin

check_all(df)
```
## Correct Time Data
```{python}
# 'date' is in UTC, but month/day are in local time. Fix?
```


## Output Cleaned Data
```{python}
df.to_csv('cleaned_hurricane_data.csv')
print("Cleaned data saved to 'cleaned_hurricane_data.csv'")
```
